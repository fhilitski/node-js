<html>
<head> 
  <link rel='shortcut icon' href='/favicon.ico' type='image/x-icon'>
  <link rel='icon' href='/favicon.ico' type='image/x-icon'>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src='/socket.io/socket.io.js'></script>
  <script>
    $(document).ready(function() {
	var socket = io.connect('http://10.0.0.85:3000');
  	var rates_div = $('div#rates');

	socket.on('msg-connect', function(data) {
	  $('#conn-status').text(data.status);
	  $('#msg-info').html('<p> Client ID: ' + data.id + '</p>');
	});
	socket.on('msg-info', function(data) {
		$('#msg-info').text(data.data)
	});
	socket.on('msg-rate', function(data){
		var rate_id = data.market;
		var rate_obj = rates_div.children('#'+rate_id);
		var msg = "<p id='" + rate_id + "'>" + rate_id + ": <span>" + data.rate + "</span></p>";  
		if (rate_obj.length == 0){
			rates_div.append(msg);
		}
		else {
			rate_obj.children('span').text(data.rate)
			.fadeTo('fast',0.1).fadeTo('fast',1);
		};
		$('#timestamp').text(data.timestamp)
	});
	socket.on('msg-prof', function(data){
		$('#prof').text(data.profitability)
	});
    });
  </script>
</head>
<title>GDAX ticker page </title>
<body>
<h1>GDAX ticker</h1>  
<h2></h2>
<div id='info'>
	<p>
	Server connection: <span id='conn-status'>NOT established</span>		</p>
	<p> Last update: <span id='timestamp'></span></p>
	<p id='msg-info'></p>
</div>
<div id='rates'>
</div>
<div>
 	<p> Profitability: <span id='prof'></span></p>
</div>
<div style='font-size:small'>
	Powered by Node.js
</div>
</body>
</html>
 
